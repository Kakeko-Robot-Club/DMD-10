# DMD-10
ディスクリート部品によるDCブラシモータドライバ
## 目次
 - [仕様](#仕様)
 - [変更履歴](#変更履歴)
 - [発注](#発注)
 - [部品実装](#部品実装)
 - [使い方](#使い方)
## 仕様
### 絶対最大定格
| 項目                  | 記号            | Max      | 単位 | 
| --------------------- | :-------------: | :------: | :--: | 
| モータ出力電流(rms)   | I<sub>OUT</sub>      | 10       | A    | 
| モータ出力電流(peak)  | I<sub>OUT_PEAK</sub> | 17       | A    | 
| モータ電源電圧        | V<sub>DD</sub>       | 0~16     | V    | 
| ロジック入力電圧      | V<sub>IN</sub>       | -6~23    | V    | 
| 保存温度             | T<sub>S</sub>      | -55~125   | ℃   | 
### 電気的特性・動作範囲
| 項目                  | 記号            | Min | Typ. | Max | 単位 | コンディション    | 
| --------------------- | :-------------: | :-: | :--: | :-: | :--: | ----------------- | 
| モータ電源電圧        | V<sub>DD</sub>  | 6   | -    | 16  | V    |                   | 
| ロジック入力電圧(High)| V<sub>IH</sub>  | 3.6 | -    | 20  | V    |                   | 
| ロジック入力電圧(Low) | V<sub>IL</sub>  | 0   | -    | 1.4 | V    |                   | 
| ロジックPWM周波数    | f<sub>IN</sub>  | -   | -    | 27  | kHz    |                   | 
| ロジック入力電流      | I<sub>IN</sub>  | -   | 10   | -   | mA   | V<sub>IN</sub>=5V | 
### その他
| 項目                  | 記号            | Min | Typ. | Max | 単位 | 備考              | 
| --------------------- | :-------------: | :-: | :--: | :-: | :--: | ----------------- | 
| 基板サイズ(縦)        |                 | -   | 55   | -   | mm   |                   | 
| 基板サイズ(横)        |                 | -   | 60   | -   | mm   |                   | 
| 取り付け穴サイズ      |                 | -   | 3.2  | -   | mm   | M3ネジ用          | 
| 取り付け穴ピッチ(縦)  |                 | -   | 46   | -   | mm   |                   | 
| 取り付け穴ピッチ(横)  |                 | -   | 35   | -   | mm   |                   | 
### 図
 - [回路図](https://github.com/Kakeko-Robot-Club/DMD-10/blob/main/preview/schematic.pdf)
 - [基板外形図](https://github.com/Kakeko-Robot-Club/DMD-10/blob/main/preview/pcb.pdf)
## 変更履歴
 - Rev. A
	 - 初版(GitHubには未掲載)
 - Rev. B
	 - 部品リファレンス番号の振り直し
## 発注
 - 発注手順は[Elecrow](https://www.elecrow.com/pcb-manufacturing.html)に発注する際の手順を示しているため、その他の業者に発注する際は各業者の指示に従うこと。
 - 下の1～4の手順が難しい場合、このリポジトリの中にあるgerberフォルダの中のファイルを使用しても良い。ただし、手順1が行えないため注意。
 - 設定はKiCad v5系を元にしているため、その他のバージョンの場合は同等の設定にすること。
1. KiCadのPcbnewを用いて基板型番の下にある週番号を振り直す。
	 - この手順は省略できるが、製造時期を明確にするために行ったほうが良い。
2. Pcbnewから、ファイル→プロットと進み、出てきた画面で次のように設定をし、「製造ファイル出力」を押す。
	 - 出力フォーマット: ガーバー
	 - 出力ディレクトリ: gerberなど分かりやすいもの
	 - 含まれるレイヤ
		 - [x] F.Cu
		 - [x] B.Cu
		 - [x] F.SilkS
		 - [x] B.SilkS
		 - [x] F.Mask
		 - [x] B.Mask
		 - [x] Edge.Cuts
		 - その他はチェックを外す
	 - 全般オプション
		 - [x] フットプリントの定数をプロット
		 - [x] フットプリントのリファレンスをプロット
		 - [x] 基板外形レイヤーのデータを他のレイヤーから除外
		 - [x] シルクからパッドを除外
		 - その他はチェックを外す
		 - デフォルトの線幅: 0.1mm
	 - ガーバーオプション
		 - [x] Protelの拡張子を使用
		 - [x] シルクをレジストで抜く
		 - [x] ネットリスト属性を含む
		 - その他はチェックを外す
		 - 座標フォーマット: 4.6, 単位 mm
3. 製造ファイル出力ボタンの右の方にある、「ドリルファイルを生成...」ボタンから、次のように設定し、「ドリルファイルを生成」を押す。
	 - 出力フォルダ: 製造ファイル出力で設定したものと同じもの
	 - ドリルファイルフォーマット: Excellon
		 - チェックはすべて外す
		 - 長円穴ドリルモードは「routeコマンドを使用」にチェック
	 - マップファイルフォーマット: ガーバー
	 - ドリル原点: 絶対位置
	 - ドリル単位: mm
	 - ゼロの扱い: 後方ゼロ省略
4. 基板プロジェクトフォルダの中のフォルダ、または自分で設定したフォルダの中に生成したファイル群があるので、次のようにリネームする。
	 - DMD-10-Edge.Cuts.gm1のみ、拡張子がgmlに変わっているため注意

	| 元ファイル名         | リネーム後      | 
	| -------------------- | --------------- | 
	| DMD-10-B.Cu.gbl      | DMD-10.gbl      | 
	| DMD-10-B.Mask.gbs    | DMD-10.gbs      | 
	| DMD-10-B.SilkS.gbo   | DMD-10.gbo      | 
	| DMD-10-Edge.Cuts.gm1 | DMD-10.gml      | 
	| DMD-10-F.Cu.gtl      | DMD-10.gtl      | 
	| DMD-10-F.Mask.gts    | DMD-10.gts      | 
	| DMD-10-F.SilkS.gto   | DMD-10.gto      | 
	| DMD-10-NPTH.drl      | DMD-10-NPTH.txt | 
	| DMD-10-PTH.drl       | DMD-10-PTH.txt  | 
5. ファイルをZIPファイルに圧縮する。
6. [Elecrow](https://www.elecrow.com/pcb-manufacturing.html)にZIPファイルをアップロードし、次のような設定で発注する。
	 - Elecrowにログインしておくこと。

	| 項目                 | 設定             | 備考                                                   | 
	| -------------------- | :--------------: | ------------------------------------------------------ | 
	| Layer                | 2 layers         | 変更しないこと。                                       | 
	| Dimensions           | 60 x 55          | 変更しないこと。                                       | 
	| PCB Qty              | 必要枚数を設定   | 10枚までは安い。設定より少し多めに届くことが多い。     | 
	| Different PCB Design | 1                | 変更しないこと。                                       | 
	| PCB Thickness        | 1.6              | 薄くできるが非推奨。厚くすると高くなる。               | 
	| PCB Color            | 基板色を設定     | 一部の色は高い。                                       | 
	| Surface Finish       | HASL             | 鉛フリーや金メッキなども指定できるが高くなる。         | 
	| Castellated Hole     | No               | 変更しないこと。                                       | 
	| Copper Weight        | 1oz              | 2ozは基板銅箔が厚くなるが高くなる。                    | 
	| PCB Stencil          | No               | ステンシルは表面実装部品のリフロー半田に使うので不要。 | 
	| Production Time      | 4-7 working days | Rushなどにしてもそこまで早くならない。                 | 
	| Country              | Japan            | 配送先の国なので日本を選択。                           | 
	| Shipping Cost        | Sagawa           | 一番安いものを選んでおけばよい。                       | 
## 部品実装
 - 部品リスト
	| リファレンス | 部品                | 秋月電子                                                                                                                        | 代替品情報                                              | 
	| ------------ | ------------------- | ------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------- | 
	| D1～D4       | SBM1045VSS          | [I-15642](https://akizukidenshi.com/catalog/g/gI-15642/)                                                                        | I<sub>F</sub>>10A, V<sub>R</sub>>16V                    | 
	| J1～J4       | PCB-20(632F)        | [C-05115](https://akizukidenshi.com/catalog/g/gC-05115/)                                                                        | 15A以上流せるもの, できるだけ金属面積が広いもの         | 
	| J5           | PH-1x40RG(2)        | [C-01627](https://akizukidenshi.com/catalog/g/gC-01627/)                                                                        | 2.54mmピッチ, L字                                       | 
	| Q1, Q2       | MTA100N10KRI3       | 1個: [I-15846](https://akizukidenshi.com/catalog/g/gI-15846/)<br>10個: [I-15847](https://akizukidenshi.com/catalog/g/gI-15847/) | TO-251, Nch, I<sub>D</sub>>2A, V<sub>GS(th)</sub><4V    | 
	| Q3, Q5       | IRFU5505PBF         | [I-06021](https://akizukidenshi.com/catalog/g/gI-06021/)                                                                        | TO-251, Pch, I<sub>D</sub><-15A, V<sub>GS(th)</sub>>-4V | 
	| Q4, Q6       | IRLU3410PBF         | [I-06025](https://akizukidenshi.com/catalog/g/gI-06025/)                                                                        | TO-251, Nch, I<sub>D</sub>>15A, V<sub>GS(th)</sub><4V   | 
	| R1～R4       | 300Ωカーボン抵抗   | [R-07811](https://akizukidenshi.com/catalog/g/gR-07811/)                                                                        |                                                         | 
	| R5, R6       | 10kΩカーボン抵抗   | [R-07838](https://akizukidenshi.com/catalog/g/gR-07838/)                                                                        |                                                         | 
	| R7～R10      | 10Ωカーボン抵抗    | [R-07795](https://akizukidenshi.com/catalog/g/gR-07795/)                                                                        |                                                         | 
	| RN1          | 1kΩ 4素子集合抵抗  | [R-14225](https://akizukidenshi.com/catalog/g/gR-14225/)                                                                        |                                                         | 
	| RN2          | 10kΩ 4素子集合抵抗 | [R-11909](https://akizukidenshi.com/catalog/g/gR-11909/)                                                                        |                                                         | 
	| U1, U2       | UPC817CG-D04-T      | [I-16090](https://akizukidenshi.com/catalog/g/gI-16090/)                                                                        | PC817系フォトカプラ                                     | 
 - 注意点
	 - 抵抗やダイオードは縦取り付けになるよう、リードを曲げること。
	 - リードを曲げた抵抗を取り付ける際、基板から浮かないように取り付けること。
		 - 浮いている場合、抵抗が左右に曲がりやすくなり、ショートの原因になるため注意。
	 - 放熱のため、FETの頭の部分の半田付けは確実に行う。
		 - ランドが広いため、大出力の半田ごてを用いたほうが良い。
	 - ネジ端子はよく温めないと半田が流れないため、やけどに注意。
	 - 言うまでもなく、部品の向き・極性の間違い、定数の間違いに注意する。
## 使い方
1. 次のように接続する。
	| 端子      | リファレンス | 接続先             | 
	| --------- | ------------ | ------------------ | 
	| POWER IN  | J2           | モータ電源プラス   | 
	| POWER GND | J3           | モータ電源マイナス | 
	| MOTOR OUT | J1, J4       | DCブラシモータ     | 
	| IN1       | J5           | マイコン等出力端子 | 
	| IN2       | J5           | マイコン等出力端子 | 
	| GND       | J5           | マイコン等グランド | 
2. マイコン等から次の表に従い、IN1・IN2に信号を出力する。
	| IN2 | IN1 | J4  | J1  | モータ   | 
	| --- | --- | --- | --- | -------- | 
	| 0   | 0   | 1   | 1   | ブレーキ | 
	| 0   | 1   | 1   | 0   | 回転     | 
	| 1   | 0   | 0   | 1   | 逆回転   | 
	| 1   | 1   | 0   | 0   | ブレーキ | 
  
	*IN1・IN2欄は入力状態、J1・J4欄は出力状態、モータ欄は出力状態によるモータの状態を表す。  
	*IN1・IN2については0をV<sub>IL</sub>、1をV<sub>IH</sub>（PWM入力含む）に従うものとする。  
	*J1・J4については0を0V、1をV<sub>DD</sub>に従うものとする。

### 使用上の注意
 - 各端子をショートさせないこと。
 - 熱がこもるような狭い空間で使用しないこと。
 - 定格を超えての使用をしないこと。
 - 異常発熱がある場合は使用しないこと。
